{"version":3,"sources":["view-meeting.component.ts"],"names":[],"mappings":"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","file":"view-meeting.component.js","sourcesContent":["import { Component, OnInit,ChangeDetectionStrategy,\n  ViewChild,\n  TemplateRef, Input} from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport {HttpClient} from '@angular/common/http';\nimport * as moment from 'moment';\nimport {\n  CalendarEvent,\n  CalendarEventAction,\n  CalendarEventTimesChangedEvent,\n  CalendarView,\n} from 'angular-calendar';\nimport {\n  startOfDay,\n  endOfDay,\n  subDays,\n  addDays,\n  endOfMonth,\n  isSameDay,\n  isSameMonth,\n  addHours,\n} from 'date-fns';\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { Subject } from 'rxjs';\nimport { ActivatedRoute } from '@angular/router';\n\nconst colors: any = {\n  red: {\n    primary: '#ad2121',\n    secondary: '#FAE3E3',\n  },\n  blue: {\n    primary: '#1e90ff',\n    secondary: '#D1E8FF',\n  },\n  yellow: {\n    primary: '#e3bc08',\n    secondary: '#FDF1BA',\n  },\n};\n\n\n@Component({\n  selector: 'app-view-meeting',\n  templateUrl: './view-meeting.component.html',\n  styleUrls: ['./view-meeting.component.css']\n})\nexport class ViewMeetingComponent implements OnInit {\n\n  @ViewChild('modalContent', { static: true }) modalContent: TemplateRef<any>;\n  view: CalendarView = CalendarView.Week;\n  CalendarView = CalendarView;\n  viewDate: Date = new Date();\n  modalData: {\n    action: string;\n    event: CalendarEvent;\n  };\n  actions: CalendarEventAction[] = [\n    {\n      label: '<i class=\"fas fa-fw fa-pencil-alt\"></i>',\n      a11yLabel: 'Edit',\n      onClick: ({ event }: { event: CalendarEvent }): void => {\n        this.handleEvent('Edited', event);\n      },\n    },\n    {\n      label: 'Delete',\n      a11yLabel: 'Delete',\n      onClick: ({ event }: { event: CalendarEvent }): void => {\n        this.events = this.events.filter((iEvent) => iEvent !== event);\n        this.handleEvent('Deleted', event);\n      },\n    },\n  ];\n  events: CalendarEvent[] = [];\n  activeDayIsOpen: boolean = true;\n  refresh: Subject<any> = new Subject();\n  allMeeting =[];\n  roomNo:any;\n  minDate = new Date();\n  meetingForm = new FormGroup({\n    agenda: new FormControl(),\n    date: new FormControl(new Date()),\n    start_time: new FormControl(),\n    end_time: new FormControl(),\n    room_id: new FormControl(),\n    name: new FormControl(),\n  });\n  @Input() dayStartHour: number = 9;\n  @Input() dayEndHour: number = 18;\n  @Input() weekStartsOn: number = 1;\n\n  constructor(private http: HttpClient, private modal: NgbModal, private route: ActivatedRoute) { }\n\n  ngOnInit(): void {\n    this.roomNo = this.route.params['_value']['roomId'];\n    this.getRooms(this.roomNo);\n    this.meetingForm = new FormGroup({\n      agenda: new FormControl(),\n      date: new FormControl(new Date()),\n      start_time: new FormControl(),\n      end_time: new FormControl(),\n      room_id: new FormControl(this.roomNo),\n      name: new FormControl(),\n    });\n  }\n\n\n  getRooms(roomId){\n    this.http.post('http://localhost:8080/check_availability',  {room_id:roomId}).subscribe((res) =>{\n      this.allMeeting = res['response'];\n      this.events = [];\n      this.allMeeting.forEach((res)=>{\n        // get start time \n        const sTime = res.start_time;\n        const t1: any = sTime.split(' ');\n        const t2: any = t1[0].split(':');\n        t2[0] = (t1[1] === 'PM' ? (1*t2[0] + 12) : t2[0]);\n        const time24 = (t2[0] < 10 ? '0' + t2[0] : t2[0]) + ':' + t2[1];\n        let snewdate = moment(res.date * 1000).toDate().toString();\n        const completeSDate = snewdate.replace(\"00:00\", time24.toString());\n\n        // get end time \n        const eTime = res.end_time;\n        const et1: any = eTime.split(' ');\n        const et2: any = et1[0].split(':');\n        et2[0] = (et1[1] === 'PM' ? (1*et2[0] + 12) : et2[0]);\n        const etime24 = (et2[0] < 10 ? '0' + et2[0] : et2[0]) + ':' + et2[1];\n        let senewdate = moment(res.date * 1000).toDate().toString();\n        const completeEDate = senewdate.replace(\"00:00\", etime24.toString());\n        console.log(moment(completeSDate).format(), moment(completeEDate).format());\n         this.events.push({ \n          start: addHours(startOfDay(moment(completeSDate).toDate()),0),\n          end: addHours(moment(completeEDate).toDate(),0),\n          title: res.agenda,\n          allDay: false,\n          color: colors.red,\n          actions: this.actions,\n          id:res.id\n         })\n      });\n   });\n  }\n\n  \n  dayClicked({date, events}: { date: Date; events: CalendarEvent[] }): void {\n    if (isSameMonth(date, this.viewDate)) {\n      if (\n        (isSameDay(this.viewDate, date) && this.activeDayIsOpen === true) ||\n        events.length === 0\n      ) {\n        this.activeDayIsOpen = false;\n      } else {\n        this.activeDayIsOpen = true;\n      }\n      this.viewDate = date;\n    }\n  }\n\n  eventTimesChanged({\n                      event,\n                      newStart,\n                      newEnd\n                    }: CalendarEventTimesChangedEvent): void {\n    this.events = this.events.map(iEvent => {\n      if (iEvent === event) {\n        return {\n          ...event,\n          start: newStart,\n          end: newEnd\n        };\n      }\n      return iEvent;\n    });\n    this.handleEvent('Dropped or resized', event);\n  }\n\n  handleEvent(action: string, event: CalendarEvent): void {\n    this.modalData = {event, action};\n    console.log(event,action);\n   // this.modal.open(this.modalContent, {size: 'lg'});\n    if(action == 'Deleted') {\n       this.http.post('http://localhost:8080/delete_meeting',  {id:event.id}).subscribe((res) =>{\n       \n       });\n    }\n  }\n\n  addEvent(): void {\n    this.events = [\n      ...this.events,\n      {\n        title: 'New event',\n        start: startOfDay(new Date()),\n        end: endOfDay(new Date()),\n        color: colors.red,\n        draggable: true,\n        resizable: {\n          beforeStart: true,\n          afterEnd: true\n        }\n      }\n    ];\n  }\n\n  deleteEvent(eventToDelete: CalendarEvent) {\n    debugger;\n    this.events = this.events.filter(event => event !== eventToDelete);\n    console.log(this.events);\n  }\n\n  setView(view: CalendarView) {\n    this.view = view;\n  }\n\n  closeOpenMonthViewDay() {\n    this.activeDayIsOpen = false;\n  }\n\n  addNewMeeting(){\n    this.meetingForm.value.date = moment(this.meetingForm.value.date).unix();\n    this.http.post('http://localhost:8080/insert_meeting',  this.meetingForm.value).subscribe((res)=>{\n       this.meetingForm = new FormGroup({\n        agenda: new FormControl(),\n        date: new FormControl(),\n        start_time: new FormControl(),\n        end_time: new FormControl(),\n        room_id: new FormControl(),\n        name: new FormControl(),\n      });    \n      this.getRooms(this.roomNo);\n    });\n  }\n\n  myDateFilter = (d: Date | null): boolean => {\n    const day = (d || new Date()).getDay();\n    return day !== 0 && day !== 6;\n  } \n\n}\n"]}