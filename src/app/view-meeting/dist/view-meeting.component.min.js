"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__decorate=this&&this.__decorate||function(e,t,o,n){var r,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;0<=s;s--)(r=e[s])&&(i=(a<3?r(i):3<a?r(t,o,i):r(t,o))||i);return 3<a&&i&&Object.defineProperty(t,o,i),i},__spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<o;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,r++)n[r]=a[i];return n};exports.__esModule=!0;var core_1=require("@angular/core"),forms_1=require("@angular/forms"),moment=require("moment"),angular_calendar_1=require("angular-calendar"),date_fns_1=require("date-fns"),rxjs_1=require("rxjs"),colors={red:{primary:"#ad2121",secondary:"#FAE3E3"},blue:{primary:"#1e90ff",secondary:"#D1E8FF"},yellow:{primary:"#e3bc08",secondary:"#FDF1BA"}},ViewMeetingComponent=function(){function e(e,t,o){var n=this;this.http=e,this.modal=t,this.route=o,this.view=angular_calendar_1.CalendarView.Week,this.CalendarView=angular_calendar_1.CalendarView,this.viewDate=new Date,this.actions=[{label:'<i class="fas fa-fw fa-pencil-alt"></i>',a11yLabel:"Edit",onClick:function(e){var t=e.event;n.handleEvent("Edited",t)}},{label:"Delete",a11yLabel:"Delete",onClick:function(e){var t=e.event;n.events=n.events.filter(function(e){return e!==t}),n.handleEvent("Deleted",t)}}],this.events=[],this.activeDayIsOpen=!0,this.refresh=new rxjs_1.Subject,this.allMeeting=[],this.minDate=new Date,this.meetingForm=new forms_1.FormGroup({agenda:new forms_1.FormControl,date:new forms_1.FormControl(new Date),start_time:new forms_1.FormControl,end_time:new forms_1.FormControl,room_id:new forms_1.FormControl,name:new forms_1.FormControl}),this.dayStartHour=9,this.dayEndHour=18,this.weekStartsOn=1,this.myDateFilter=function(e){var t=(e||new Date).getDay();return 0!==t&&6!==t}}return e.prototype.ngOnInit=function(){this.roomNo=this.route.params._value.roomId,this.getRooms(this.roomNo),this.meetingForm=new forms_1.FormGroup({agenda:new forms_1.FormControl,date:new forms_1.FormControl(new Date),start_time:new forms_1.FormControl,end_time:new forms_1.FormControl,room_id:new forms_1.FormControl(this.roomNo),name:new forms_1.FormControl})},e.prototype.getRooms=function(e){var m=this;this.http.post("http://localhost:8080/check_availability",{room_id:e}).subscribe(function(e){m.allMeeting=e.response,m.events=[],m.allMeeting.forEach(function(e){var t=e.start_time.split(" "),o=t[0].split(":");o[0]="PM"===t[1]?1*o[0]+12:o[0];var n=(o[0]<10?"0"+o[0]:o[0])+":"+o[1],r=moment(1e3*e.date).toDate().toString().replace("00:00",n.toString()),a=e.end_time.split(" "),i=a[0].split(":");i[0]="PM"===a[1]?1*i[0]+12:i[0];var s=(i[0]<10?"0"+i[0]:i[0])+":"+i[1],l=moment(1e3*e.date).toDate().toString().replace("00:00",s.toString());console.log(moment(r).format(),moment(l).format()),m.events.push({start:date_fns_1.addHours(date_fns_1.startOfDay(moment(r).toDate()),0),end:date_fns_1.addHours(moment(l).toDate(),0),title:e.agenda,allDay:!1,color:colors.red,actions:m.actions,id:e.id})})})},e.prototype.dayClicked=function(e){var t=e.date,o=e.events;date_fns_1.isSameMonth(t,this.viewDate)&&(date_fns_1.isSameDay(this.viewDate,t)&&!0===this.activeDayIsOpen||0===o.length?this.activeDayIsOpen=!1:this.activeDayIsOpen=!0,this.viewDate=t)},e.prototype.eventTimesChanged=function(e){var t=e.event,o=e.newStart,n=e.newEnd;this.events=this.events.map(function(e){return e===t?__assign(__assign({},t),{start:o,end:n}):e}),this.handleEvent("Dropped or resized",t)},e.prototype.handleEvent=function(e,t){this.modalData={event:t,action:e},console.log(t,e),"Deleted"==e&&this.http.post("http://localhost:8080/delete_meeting",{id:t.id}).subscribe(function(e){})},e.prototype.addEvent=function(){this.events=__spreadArrays(this.events,[{title:"New event",start:date_fns_1.startOfDay(new Date),end:date_fns_1.endOfDay(new Date),color:colors.red,draggable:!0,resizable:{beforeStart:!0,afterEnd:!0}}])},e.prototype.deleteEvent=function(t){this.events=this.events.filter(function(e){return e!==t}),console.log(this.events)},e.prototype.setView=function(e){this.view=e},e.prototype.closeOpenMonthViewDay=function(){this.activeDayIsOpen=!1},e.prototype.addNewMeeting=function(){var t=this;this.meetingForm.value.date=moment(this.meetingForm.value.date).unix(),this.http.post("http://localhost:8080/insert_meeting",this.meetingForm.value).subscribe(function(e){t.meetingForm=new forms_1.FormGroup({agenda:new forms_1.FormControl,date:new forms_1.FormControl,start_time:new forms_1.FormControl,end_time:new forms_1.FormControl,room_id:new forms_1.FormControl,name:new forms_1.FormControl}),t.getRooms(t.roomNo)})},__decorate([core_1.ViewChild("modalContent",{static:!0})],e.prototype,"modalContent"),__decorate([core_1.Input()],e.prototype,"dayStartHour"),__decorate([core_1.Input()],e.prototype,"dayEndHour"),__decorate([core_1.Input()],e.prototype,"weekStartsOn"),e=__decorate([core_1.Component({selector:"app-view-meeting",templateUrl:"./view-meeting.component.html",styleUrls:["./view-meeting.component.css"]})],e)}();exports.ViewMeetingComponent=ViewMeetingComponent;
//# sourceMappingURL=view-meeting.component.min.js.map
